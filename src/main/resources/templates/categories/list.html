<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>카테고리 관리</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
</head>

<body class="bg-light">
<div class="container py-5" style="max-width: 900px;">

    <div class="d-flex justify-content-between align-items-center mb-3">
        <div>
            <h1 class="h4 mb-1"><i class="bi bi-tags text-primary me-1"></i> 카테고리</h1>
            <p class="text-muted small mb-0">글 작성 시 선택할 카테고리를 관리합니다.</p>
        </div>
        <a class="btn btn-sm btn-outline-secondary" th:href="@{/posts}">
            게시글로
        </a>
    </div>

    <div th:if="${message}" class="alert alert-success" th:text="${message}">msg</div>

    <!-- 생성 폼 -->
    <div class="card shadow-sm mb-3">
        <div class="card-body p-4">
            <h2 class="h6 mb-3">카테고리 추가</h2>

            <!-- CategoryRequest 바인딩 대신 name 파라미터로 전송 -->
            <form th:action="@{/categories}" method="post" class="row g-2">
                <div class="col-md-8">
                    <input type="text" class="form-control" name="name" placeholder="예: 자유, 질문, 공지" required>
                </div>
                <div class="col-md-4 d-grid">
                    <button type="submit" class="btn btn-primary">추가</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 목록 -->
    <div class="card shadow-sm">
        <div class="card-body p-0">
            <table class="table table-hover mb-0">
                <thead class="table-light">
                <tr>
                    <th class="px-3" style="width: 120px;">ID</th>
                    <th>이름</th>
                    <th class="text-end px-3" style="width: 160px;">액션</th>
                </tr>
                </thead>

                <tbody>
                <tr th:each="c : ${categories}">
                    <!-- ⚠️ 필드명 확인 필요: categoryId vs id -->
                    <td class="px-3" th:text="${c.categoryId}">1</td>
                    <td th:text="${c.name}">자유</td>

                    <td class="text-end px-3">
                        <form th:action="@{/categories/{id}/delete(id=${c.categoryId})}"
                              method="post"
                              class="d-inline"
                              onsubmit="return confirm('정말 삭제할까요?');">
                            <button type="submit" class="btn btn-sm btn-outline-danger">삭제</button>
                        </form>
                    </td>
                </tr>

                <tr th:if="${#lists.isEmpty(categories)}">
                    <td colspan="3" class="text-center py-4 text-muted">카테고리가 없습니다.</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
